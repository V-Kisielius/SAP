# SAP - Solar Activity Prediction

Проект для предсказания солнечных пятен с использованием модели NARX (Nonlinear AutoRegressive with eXogenous inputs).

## Описание

Этот проект использует нейронную сеть NARX (Nonlinear AutoRegressive with eXogenous inputs) для предсказания солнечных пятен на 18 месяцев вперед. 

**Основные возможности:**
- Предсказание солнечных пятен на 18 месяцев вперед
- Использование исторических данных и теоретических значений солнечной активности
- Гибкая настройка параметров через командную строку
- Поддержка работы с данными из URL или локальных файлов
- Визуализация результатов предсказаний

Модель обучена на исторических данных о солнечных пятнах и теоретических значениях солнечной активности.

## Структура проекта

```
SAP/
├── data/
│   ├── model_weights/          # Веса обученных моделей для разных горизонтов
│   └── theoretical_series.csv  # Теоретические данные солнечной активности
├── scripts/
│   ├── data_x18.py            # Класс для подготовки данных
│   └── model_x18.py           # Архитектура модели NARX
├── predict.py                 # Основной скрипт для предсказаний
├── requirements.txt           # Зависимости проекта
└── README.md                  # Документация проекта
```

## Установка

1. Клонируйте репозиторий:
```bash
git clone https://github.com/V-Kisielius/SAP/tree/master
cd SAP
```

2. Установите зависимости:
```bash
pip install -r requirements.txt
```

## Использование

### Базовое использование

Запуск с параметрами по умолчанию (данные скачиваются автоматически по URL):

```bash
python predict.py
```

### Примеры использования

**Создание графика с предсказаниями:**
```bash
python predict.py --need_plot
```

**Использование локального файла с данными SSN:**
```bash
python predict.py --ssn_data data/local_ssn.csv
```

**Расширенный пример с несколькими параметрами:**
```bash
python predict.py --depth 6 --need_plot --device cuda --path_to_save results
```

**Использование другого URL для данных:**
```bash
python predict.py --ssn_data https://example.com/custom_data.csv
```

### Параметры командной строки

| Параметр | Описание | По умолчанию |
|----------|----------|--------------|
| `--path_to_save` | Директория для сохранения предсказаний | `predictions` |
| `--depth` | Глубина предсказания - количество последних месяцев для анализа. Если сейчас октябрь и `depth=4`, то будут предсказаны значения, соответствующие октябрю, сентябрю, августу и июлю. **Важно:** Горизонт предсказания в 18 месяцев и `depth` отвечают за разное! | `4` |
| `--device` | Устройство для вычислений: `cpu`, `cuda`, или `mps` | Автоопределение |
| `--need_plot` | Создать график с предсказаниями | `False` |
| `--ssn_data` | URL для скачивания данных SSN или путь к локальному файлу | `https://www.sidc.be/SILSO/DATA/SN_ms_tot_V2.0.csv` |

## Архитектура модели

Модель NARX использует:
- **Входные данные**: Теоретические значения солнечной активности и исторические данные о солнечных пятнах
- **Архитектура**: Полносвязная нейронная сеть с сигмоидными активациями и Softplus на выходе
- **Горизонт предсказания**: 18 месяцев вперед
- **Нормализация**: Данные нормализуются по максимальному значению наблюдаемого ряда

## Данные

Проект использует два источника данных:

1. **Данные SSN (Sunspot Number)** - данные о солнечных пятнах:
   - По умолчанию скачиваются автоматически с [SILSO (Sunspot Index and Long-term Solar Observations)](https://www.sidc.be/SILSO/datafiles)
   - Можно указать локальный файл через параметр `--ssn_data`
   - Формат: CSV с разделителем `;`, должны содержать колонки с десятичной датой и значениями SSN

2. **Теоретические данные** - хранятся в локальном файле `data/theoretical_series.csv`
   - Содержат теоретические значения солнечной активности
   - Используются как экзогенные входы для модели NARX

### Формат выходных данных

Предсказания сохраняются в CSV файлы в указанной директории (`predictions` по умолчанию).
